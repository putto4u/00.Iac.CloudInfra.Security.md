같은 PC나 노트북 내에서 **공격용 VM(예: Kali Linux)**과 **방어용 VM(예: Windows Server 또는 Ubuntu + 보안 툴)**을 동시에 구동하는 환경은 네트워크 구성과 하이퍼바이저 설정이 핵심입니다.

실습 환경의 안정성과 정밀도를 보장하기 위한 **Step-by-Step 가이드**를 정리해 드리니 참고하세요. 

---

### 1. BIOS/UEFI 설정 (하드웨어 수준)

가장 먼저 하드웨어 가속 기능이 활성화되어 있어야 합니다.

* **설정 값:** `Intel Virtualization Technology (VT-x)` 또는 `AMD-V (SVM Mode)`를 **Enabled**로 설정합니다.
* **이유:** 이 기능이 꺼져 있으면 하이퍼바이저(VirtualBox 등)가 가상 머신을 64비트로 구동할 수 없거나 속도가 매우 느려집니다.

---

### 2. 하이퍼바이저 선택 및 Windows 기능 설정

공격/방어 실습 시에는 **VirtualBox**를 주력으로 사용하는 것을 추천하며, 이때 윈도우 기능 설정은 다음과 같습니다.

* **추천 설정:** **'Windows 하이퍼바이저 플랫폼'**과 **'가상 머신 플랫폼'**을 **해제(OFF)** 하는 것이 가장 깨끗합니다.
* **이유:** 윈도우 하이퍼바이저 엔진이 개입하면 VirtualBox의 고유한 네트워크 드라이버 제어 성능이 떨어질 수 있습니다.
* **명령어 (관리자 권한):**
```bash
bcdedit /set hypervisorlaunchtype off

```


* 단, 이 설정을 하면 **WSL2나 Docker Desktop을 동시에 쓸 수 없으므로**, 오직 VM 실습에 집중할 때만 권장합니다. (WSL2와 병행해야 한다면 기능을 **ON** 상태로 두어야 합니다.)



---

### 3. VM 간 네트워크 구성 (가장 중요)

공격 VM이 방어 VM을 식별하고 공격할 수 있으려면 두 VM이 동일한 가상 네트워크 안에 있어야 합니다.

* **추천 모드: 호스트 전용 어댑터 (Host-Only Adapter)**
* **장점:** 외부 인터넷과는 격리되면서, 호스트(내 노트북)와 가상 머신들끼리만 통신할 수 있는 안전한 실험실이 만들어집니다.
* **방법:** 1.  VirtualBox의 `파일 > 도구 > 네트워크 관리자`에서 새로운 Host-Only 네트워크(예: `vboxnet0`)를 생성합니다.
2.  두 VM의 설정에서 `네트워크 > 어댑터 1`을 모두 **호스트 전용 어댑터**로 선택합니다.



---

### 4. 공격용 vs 방어용 VM 세팅 팁

| 구분 | 공격용 VM (Kali Linux) | 방어용 VM (Target) |
| --- | --- | --- |
| **네트워크 설정** | 호스트 전용 + NAT (도구 업데이트용) | **호스트 전용**만 권장 (외부 노출 방지) |
| **리소스 할당** | RAM 2GB~4GB (GUI 사용 시) | 서비스 사양에 맞게 조정 |
| **보안 설정** | 실시간 감시 제외 (해킹 도구 검출 방지) | 실시간 감시/방화벽 활성화 (방어 실습) |

---

### 💡 실전 팁: 중첩 가상화 (Nested Virtualization)

방어용 VM 내부에서 Docker 컨테이너(예: Honeypot)를 띄워 방어하는 실습을 하려면, VirtualBox 설정에서 해당 VM의 **'VT-x/AMD-V'** 기능을 가상 머신 내부로 전달해 주어야 합니다.

> **주의사항:** 공격 도중 호스트 PC(내 노트북)가 감염되는 것을 막기 위해, 실습 중에는 반드시 **공유 폴더 기능을 끄거나 읽기 전용으로 설정**하는 습관을 들이는 것이 좋습니다.

### 다음 단계 제안

네트워크 설정이 완료되었다면, **Kali Linux에서 nmap을 이용해 방어용 VM의 IP를 스캐닝하는 것**부터 시작해 볼 수 있습니다. 두 VM 간에 핑(Ping)이 통하는지 먼저 확인해 보시겠습니까?

[VirtualBox 가상 네트워크 모드별 차이점 가이드](https://www.virtualbox.org/manual/ch06.html)
출처: Oracle VirtualBox 공식 문서
